<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>Game List</title>
  <link rel="stylesheet" th:href="@{/css/gamelist.css}" />
</head>
<body>

<div class="header">
  <h1>Game List</h1>
  <form th:action="@{/games}" method="get">
    <input type="text" name="keyword" placeholder="Search..." th:value="${keyword}" />
    <button type="submit">Search</button>
  </form>
</div>

<div class="toolbar">
  <form th:action="@{/games}" method="get" class="filters">
    <select name="category">
      <option value="" th:selected="${category == null}">All Categories</option>
      <option th:each="cat : ${categories}"
              th:value="${cat.categoryId}"
              th:text="${cat.categoryName}"
              th:selected="${cat.categoryId == category}">
      </option>
    </select>
    <button type="submit" class="btn">Filter</button>
  </form>
  <a th:href="@{/games/new}" class="btn">Add New Game</a>
</div>

<form th:action="@{/games}" method="post">
  <input type="hidden" name="action" value="delete" />
  <table>
    <thead>
    <tr>
      <th><input type="checkbox" id="selectAll" /></th>
      <th>ID</th>
      <th>Code</th>
      <th>Name (Default)</th>
      <!-- Nếu muốn hiện category name trong GameDTO thì thêm cột này -->
      <th>Actions</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="game : ${games.content}">
      <td><input type="checkbox" name="ids" th:value="${game.gameId}" /></td>
      <td th:text="${game.gameId}"></td>
      <td th:text="${game.gameCode}"></td>
      <td th:text="${game.gameName}"></td>
      <td>
        <a th:href="@{/games/{id}(id=${game.gameId})}" class="btn">Edit</a>
      </td>
    </tr>
    </tbody>
  </table>

  <div class="delete-bar">
    <button type="submit" class="btn">Delete Selected</button>
  </div>
</form>

<!-- Pagination -->
<div class="pagination">
  <a th:if="${page > 1}" th:href="@{/games(page=${page-1}, category=${category}, keyword=${keyword})}">&laquo;</a>
  <a th:each="i : ${#numbers.sequence(1, games.totalPages)}"
     th:classappend="${i == page} ? 'active'"
     th:href="@{/games(page=${i}, category=${category}, keyword=${keyword})}"
     th:text="${i}">
  </a>
  <a th:if="${page < games.totalPages}" th:href="@{/games(page=${page+1}, category=${category}, keyword=${keyword})}">&raquo;</a>
</div>

<script>
  document.getElementById("selectAll").addEventListener("change", function() {
      document.querySelectorAll("input[name='ids']").forEach(cb => cb.checked = this.checked);
  });
</script>

</body>
</html>
